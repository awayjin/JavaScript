<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <link type="text/css" href="./skins/blue.css" rel="stylesheet">
    <!--<script src="./janDialog/artDialog.js"></script>-->

    <style type="text/css">
        .base-dialog{ width: 270px; height: 170px; background-color: #fff; color: #fff; border: 1px solid #c0bfbf;}
        .dialog-title{ height: 32px; line-height: 32px; text-indent: 1em; background-color: #000; }
        .dialog-content{ height: 100px;}
        .dialog-button{ height: 60px;}

/*        //        janDialog._templates =
        //                '<div class="base-dialog">'
        //                        +      '<div class="dialog-title">标题</div>'
        //                        +      '<div class="dialog-content">'
        //                        +            '内容'
        //                        +      '</div>'
        //                        +      '<div class="dialog-button">'
        //                        +          '<button class="button-text"><span>确定</span></button>'
        //                        +         '<button class="button-text"><span>取消</span></button>'
        //                        +    '</div>'
        //                        + '</div>';*/
    </style>
</head>
<body>
<div style="height: 1200px"></div>
<script>
    ;(function(window, undefined){
        var $ = window.jan = function(selector){
            return new $.prototype.constructor(selector);
        };

        if(window.$ === undefined){
            window.$ = $
        }

        $.fn = $.prototype = {
            constructor: function(selector){
                if(selector.nodeType == 1){
                    this[0] = selector;
                    return this;
                }
            },

            hasClass: function(){

            },

            html: function(content){
                var ele = this[0];
                ele.innerHTML = content;
                return this;
            },

            css: function(name, value){
//                this[0].style.name = value;

                var ele = this[0]

                if(typeof name == "string"){
                    ele.style[name] = value;
                }else{
                    for(var i in name){
                        ele.style[i] = name[i];
                    }
                }
                return this;
            }
        }
        $.fn.constructor.prototype = $.fn;




        return $;

    })(window);

    ;(function(){

        var _count = 0,
                _expando = "janDialog" + (+new Date());

        var janDialog = function(config, ok, cancle){

            config = config || {};

            var api, defaults = janDialog.defaults;

            //合并默认配置
            for(var i in defaults){
                if(config[i] === undefined){
                    config[i] = defaults[i];
                }
            }



            // !$.isArray(config.button)
            if (!config.button || !config.button.push) {
                config.button = [];
            };


            // 确定按钮
            if (ok !== undefined) {
                config.ok = ok;
            };

            if (config.ok) {
                config.button.push({
                    id: 'ok',
                    value: config.okValue,
                    callback: config.ok,
                    focus: true
                });
            };

            config.id = _expando+_count;


            return new janDialog.fn._create(config, ok, cancle);
        }

        janDialog.fn = janDialog.prototype = {
            _create: function(config, ok, cancle){
                var dom;

                this.dom = dom = this.dom || this._innerHTML(config);

                dom.wrap.css({"position":"absolute"});


                this.button.apply(this, config.button)

                this.title(config.title)
                        .content(config.content);


                this._event();

            },

            _event: function(){
                var dom = this.dom,
                        ele = dom.wrap[0];

                dom.close[0].addEventListener("click", function(){
                    ele.style.display = 'none';
                }, true);
            },

            button: function(){
              var dom = this.dom,
                      $button = dom.buttons,
                      ele = $button[0],
                      args = [].slice.call(arguments);

                var i = 0, value, button,
                        strongButton = "d-state-highlight";

                for(; i<args.length; i++){
                    value = args[i];

                    button = document.createElement("input");
                    button.type = "button";
                    button.className = "d-button"

                    button.value = args[i].value;

                    if(args[i].focus){
                        button.className = button.className + ' '+strongButton;
                    }

                    ele.insertBefore(button, null);
                }





              return this;
            },

            content: function(msg){
                var dom = this.dom,
                        $content = dom.content;

                $content.html(msg)

                this._reset();

                return this;
            },

            _reset: function(){
                this.position()

                return this;
            },

            title: function(msg){
                var i = 0,
                        dom = this.dom,
                        $title = dom.title;

                $title.html(msg)
                return this;
            },

            position: function(){
                var dom = this.dom,
                        scrollTop = document.body.scrollTop,
                        docWidth = document.documentElement.clientWidth,
                        docHeight = document.documentElement.clientHeight,
                        wrapWidth = dom.wrap[0].offsetWidth,
                        wrapHeight = dom.wrap[0].offsetHeight,
                        left = parseInt(docWidth - wrapWidth)/ 2,
                        top = parseInt(scrollTop) + 50;

                dom.wrap.css({
                    "left": left+ "px",
                    "top": top + "px"
                });

            },

            _innerHTML: function(data){
                var wrap;

                wrap = document.createElement("div");
                wrap.innerHTML = janDialog._templates.replace(/{([^}]+)}/g,
                function(matches, $1, $2, $3){
                    var value = data[$1];
                    return typeof value == "string" ? value : "";
                });

                document.body.insertBefore(wrap, document.body.firstChild);

                var i = 0,
                        dom = {},
                        name,
                        eles = wrap.getElementsByTagName("*");

                for( ; i<eles.length; i++){
                    name = eles[i].className.split("d-")[1];
                    if(name){
                        dom[name] = $(eles[i]);
                    }
                }

                dom.wrap = $(wrap);

                return dom;
            }

        }

        janDialog.fn._create.prototype = janDialog.fn;


        janDialog.defaults = {
            content: "<div class='d-loading'><span>loading..</span></div> ",

            lock: false,

            skin: null,

            title: "message",

            ok: null,

            okValue: "ok",

            cancel: null,

            value: "ok",

            callback: function(){

            }
        };



        janDialog._templates =
                '<div class="d-outer" role="dialog" tabindex="-1" aria-labelledby="d-title-{id}" aria-describedby="d-content-{id}">'
                        +	'<table class="d-border">'
                        +		'<tbody>'
                        +			'<tr>'
                        +				'<td class="d-nw"></td>'
                        +				'<td class="d-n"></td>'
                        +				'<td class="d-ne"></td>'
                        +			'</tr>'
                        +			'<tr>'
                        +				'<td class="d-w"></td>'
                        +				'<td class="d-c">'
                        +					'<div class="d-inner">'
                        +					'<table class="d-dialog">'
                        +						'<tbody>'
                        +							'<tr>'
                        +								'<td class="d-header">'
                        +									'<div class="d-titleBar">'
                        +										'<div id="d-title-{id}" class="d-title"></div>'
                        +										'<a class="d-close" href="javascript:;">×</a>'
                        +									'</div>'
                        +								'</td>'
                        +							'</tr>'
                        +							'<tr>'
                        +								'<td class="d-main">'
                        +									'<div id="d-content-{id}" class="d-content"></div>'
                        +								'</td>'
                        +							'</tr>'
                        +							'<tr>'
                        +								'<td class="d-footer">'
                        +									'<div class="d-buttons"></div>'
                        +								'</td>'
                        +							'</tr>'
                        +						'</tbody>'
                        +					'</table>'
                        +					'</div>'
                        +				'</td>'
                        +				'<td class="d-e"></td>'
                        +			'</tr>'
                        +			'<tr>'
                        +				'<td class="d-sw"></td>'
                        +				'<td class="d-s"></td>'
                        +				'<td class="d-se"></td>'
                        +			'</tr>'
                        +		'</tbody>'
                        +	'</table>'
                        +'</div>';

        $.dialog = janDialog;

    })();

    $.dialog({
        ok: function(){
            alert(111)
        },
        lock: true
    })


</script>


<script>
    $.dialog()
//    (function(window, undefine){
//        var $ = window.jan = function(){
//
//            return new $.prototype.constructor();
//        };
//
//
//        window.$  = $;
//
//
//        $.fn = $.prototype = {
//            constructor: function(){
//
//            }
//
//        }
//        $.fn.constructor.prototype = $.fn;
//
//        return $;
//    })(window);
//
//
//
//
//    (function($, window, undefined){
//
//        var janDialog = function(config, ok, cancle){
//
//            return new janDialog.fn._create(config);
//        };
//
//        janDialog.fn = janDialog.prototype = {
//
//            _create: function(){
//
//            }
//        }
//
//        janDialog.fn._create.prototype = janDialog.fn;
//
//
//        $.fn.dialog  = $.fn.janDialog = function(){
//
//        }
//
//
//        this.janDialog = $.dialog = $.janDialog = janDialog;
//
//        var cc;
//    })(this.jan || this.jQuery, this);
//
////    jan.dialog();
//    $.dialog();
</script>

</body>
</html>